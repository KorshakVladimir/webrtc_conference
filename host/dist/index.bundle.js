!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=5)}([function(e,n){var t,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var u,s=[],f=!1,l=-1;function d(){f&&u&&(f=!1,u.length?s=u.concat(s):l=-1,s.length&&m())}function m(){if(!f){var e=a(d);f=!0;for(var n=s.length;n;){for(u=s,s=[];++l<n;)u&&u[l].run();l=-1,n=s.length}u=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(e)}}function p(e,n){this.fun=e,this.array=n}function v(){}r.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];s.push(new p(e,n)),1!==s.length||f||a(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,n){e.exports=function(e,n,t){return n<t?e<n?n:e>t?t:e:e<t?t:e>n?n:e}},function(e,n,t){var o=t(1);e.exports=function(e,n,t){var r=n/2,i=Math.round(e/r*t);return o(i,0,t)}},function(e,n,t){var o=t(2);function r(e,n,t,r,i){for(var c=n.context.sampleRate,a=n.frequencyBinCount,u=o(r,c,a),s=o(i,c,a),f=s-u,l=0;u<s;u++)l+=t[u]/e;return 0===f?0:l/f}e.exports=r.bind(null,255),e.exports.floatData=r.bind(null,1)},function(e,n,t){"use strict";var o=t(3);e.exports=function(e,n,t){t=t||{};var r={fftSize:1024,bufferLen:1024,smoothingTimeConstant:.2,minCaptureFreq:85,maxCaptureFreq:255,noiseCaptureDuration:1e3,minNoiseLevel:.3,maxNoiseLevel:.7,avgNoiseMultiplier:1.2,onVoiceStart:function(){},onVoiceStop:function(){},onUpdate:function(e){}},i={};for(var c in r)i[c]=t.hasOwnProperty(c)?t[c]:r[c];var a=0,u=1,s=0,f=0,l=60,d=5,m=[],p=!0,v=void 0,h=!1,g=null,w=e.createMediaStreamSource(n),y=e.createAnalyser();y.smoothingTimeConstant=i.smoothingTimeConstant,y.fftSize=i.fftSize;var x=e.createScriptProcessor(i.bufferLen,1,1);function C(){w.connect(y),y.connect(x),x.connect(e.destination)}function T(){x.disconnect(),y.disconnect(),w.disconnect()}return C(),x.onaudioprocess=function(){var e=new Uint8Array(y.frequencyBinCount);y.getByteFrequencyData(e);var n=o(y,e,i.minCaptureFreq,i.maxCaptureFreq);if(p)return void m.push(n);n>=a&&s<l?s++:n<a&&s>f&&s--;v!==(h=s>d)&&(h?i.onVoiceStart():i.onVoiceStop(),v=h);i.onUpdate(Math.max(0,n-a)/u)},p&&(g=setTimeout(function(){p=!1;var e=(m=m.filter(function(e){return e}).sort()).length?m.reduce(function(e,n){return Math.min(e,n)},1):i.minNoiseLevel||.1;a=e*i.avgNoiseMultiplier,i.minNoiseLevel&&a<i.minNoiseLevel&&(a=i.minNoiseLevel);i.maxNoiseLevel&&a>i.maxNoiseLevel&&(a=i.maxNoiseLevel);u=1-a},i.noiseCaptureDuration)),{connect:C,disconnect:T,destroy:function(){g&&clearTimeout(g),T(),x.onaudioprocess=null}}}},function(e,n,t){"use strict";var o,r,i,c,a,u,s=t(4),f=t(0),l=document.querySelector("#localVideo"),d=document.querySelector("#remoteVideo"),m="foo",p=[];if("prod"===f.env.NODE_ENV)var v=io.connect("ec2-18-220-215-162.us-east-2.compute.amazonaws.com:9090");else v=io.connect("localhost:9090");var h={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};function g(e){v.emit("message",c,e)}function w(){try{const e=p.push(new RTCPeerConnection(null));(r=p[e-1]).setConfiguration(h),r.onicecandidate=y,r.onaddstream=T,r.onremovestream=b}catch(e){return void console.log(e)}}function y(e){e.candidate&&g({type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate})}function x(e){}function C(e){r.setLocalDescription(e),g(e)}function T(e){i=e.stream,d.srcObject=i}function b(e){}function L(e){}function S(){v.emit("voice_start"),a=!0}v.on("remove_host",function(){a=!1}),v.on("peer_to_host",function(e,n){c=e,console.log(n),w()}),v.on("host_to_peer",function(e){c=e,w(),a?r.addStream(o):r.addStream(i),r.createOffer(C,x)}),v.on("first",function(){a=!0}),v.on("message",function(e){if("offer"===e.type)r.setRemoteDescription(new RTCSessionDescription(e)),console.log("Sending answer to peer."),r.createAnswer().then(C,L);else if("answer"===e.type)r.setRemoteDescription(new RTCSessionDescription(e));else if("candidate"===e.type){var n=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});r.addIceCandidate(n)}else"bye"===e&&handleRemoteHangup()}),window.onbeforeunload=function(){v.emit("remove_peer",c)},navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(e){window.AudioContext=window.AudioContext||window.webkitAudioContext,u=new AudioContext,o=e,l.srcObject=e,function(e){s(u,e,{fftSize:1024,bufferLen:1024,smoothingTimeConstant:.2,minCaptureFreq:85,maxCaptureFreq:255,noiseCaptureDuration:1e3,minNoiseLevel:.3,maxNoiseLevel:.7,avgNoiseMultiplier:1.2,onVoiceStart:S})}(e),v.emit("create or join",m)}).catch(function(e){alert("getUserMedia() error: "+e)})}]);
//# sourceMappingURL=index.bundle.js.map